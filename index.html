<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Despierta tu Voz - Mentor Vocal</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#8e7d6d">

</head>

<body>
    <div id="authOverlay" class="overlay">
        <div class="auth-card">
            <h2>Despierta tu Voz</h2>
            <p>Introduce tus datos para hablar con el Mentor</p>

            <input type="text" id="authName" placeholder="Tu nombre para el Mentor (solo la 1a vez)">
            <input type="email" id="authEmail" placeholder="Tu correo electr√≥nico">
            <input type="password" id="authPassword" placeholder="Tu contrase√±a">

            <div class="auth-buttons">
                <button id="loginBtn">Entrar</button>
                <button id="signUpBtn" class="secondary">Registrarme</button>
            </div>
            <div class="auth-extra">
                <a href="#" id="forgotPasswordLink">¬øHas olvidado tu contrase√±a?</a>
            </div>

            <!-- Secci√≥n oculta para resetear contrase√±a -->
            <div id="resetPasswordContainer">
                <p>Introduce tu nueva contrase√±a:</p>
                <input type="password" id="newPassword" placeholder="Nueva contrase√±a">
                <button id="updatePasswordBtn">Actualizar Contrase√±a</button>
            </div>

            <p id="authError" class="error-msg"></p>
        </div>
    </div>

    <header>
        <div class="header-main">
            <img src="logo-appDTV2.png" alt="Despierta tu Voz Logo" class="app-logo">
            <h2>Despierta tu Voz</h2>
        </div>
        <p>Conexi√≥n emocional y t√©cnica 24/7</p>
    </header>

    <div class="chat-container">
        <div class="chat-header">
            <div class="chat-header-top">
                <span>Sesi√≥n con el Mentor</span>
                <div class="header-top-actions">
                    <button id="logoutBtn" class="logout-btn" title="Cerrar Sesi√≥n">SALIR</button>
                    <button id="mainHelpBtn" class="help-modulo-btn">?</button>
                </div>
            </div>
            <div id="mainHelpTooltip" class="help-tooltip">
                <h5>üí° Gu√≠a de la Pantalla Principal</h5>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_bienvenida.png" alt="Icono Bienvenida"></span>
                    <div class="help-desc"><strong>Bienvenida</strong> ‚Äì Te da la oportunidad de volver a leer el
                        mensaje inicial de Bienvenida.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_viaje.png" alt="Icono Mi Viaje"></span>
                    <div class="help-desc"><strong>Mi Viaje</strong> ‚Äì Acceso a tu ruta de autoconocimiento dividida en
                        5 M√≥dulos.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_progreso.png" alt="Icono Mi Progreso"></span>
                    <div class="help-desc"><strong>Mi Progreso</strong> ‚Äì Aqu√≠ el Mentor registra tus logros y evoluci√≥n
                        emocional.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_emergencia.png" alt="Icono Emergencia"></span>
                    <div class="help-desc"><strong>Emergencia</strong> ‚Äì Pulsa aqu√≠ si te sientes nervioso antes de
                        cantar para recibir pautas inmediatas.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_sesiones.png" alt="Icono Sesiones"></span>
                    <div class="help-desc"><strong>Sesiones 1/1</strong> ‚Äì Informaci√≥n sobre tus tutor√≠as personales y
                        reserva de espacio.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_upgrade.png" alt="Icono Mejorar Plan"></span>
                    <div class="help-desc"><strong>Mejorar Plan</strong> ‚Äì Sube de nivel para desbloquear m√°s funciones
                        y soporte del Mentor.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag"><img src="assets/icon_ajustes.png" alt="Icono Ajustes"></span>
                    <div class="help-desc"><strong>Ajustes</strong> ‚Äì Personaliza el idioma, personalidad del Mentor y
                        tus objetivos semanales.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag">
                        <div class="logout-tag">SALIR</div>
                    </span>
                    <div class="help-desc"><strong>MUY IMPORTANTE</strong>. Haz clic aqu√≠ para cerrar tu sesi√≥n y
                        asegurar que se guarden todos los datos de la conversaci√≥n.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag">
                        <div class="text-tag">Caja</div>
                    </span>
                    <div class="help-desc"><strong>Caja de texto</strong> ‚Äì Pregunta al Mentor tus dudas sobre t√©cnica,
                        partituras o emociones.</div>
                </div>
                <div class="help-item">
                    <span class="help-btn-tag">
                        <div class="mic-tag">üé§</div>
                    </span>
                    <div class="help-desc"><strong>Micr√≥fono</strong> ‚Äì Pulsa para hablar en lugar de escribir (el
                        Mentor transcribir√° tus palabras).</div>
                </div>
            </div>
            <div class="header-buttons">
                <button id="bienvenidaBtn" class="icon-nav-btn" title="Bienvenida">
                    <img src="assets/icon_bienvenida.png" alt="Bienvenida">
                </button>
                <button id="viajeBtn" class="journey-btn icon-nav-btn" title="Mi Viaje">
                    <img src="assets/icon_viaje.png" alt="Mi Viaje">
                </button>
                <button id="progresoBtn" class="icon-nav-btn" title="Mi Progreso">
                    <img src="assets/icon_progreso.png" alt="Mi Progreso">
                </button>
                <button id="botiquinBtn" class="icon-nav-btn" title="Emergencias">
                    <img src="assets/icon_emergencia.png" alt="Emergencias">
                </button>
                <button id="sesionBtn" class="premium-btn icon-nav-btn" title="Sesiones 1/1">
                    <img src="assets/icon_sesiones.png" alt="Sesiones">
                </button>
                <button id="upgradeBtn" class="upgrade-btn icon-nav-btn" title="Mejorar Plan">
                    <img src="assets/icon_upgrade.png" alt="Mejorar Plan">
                </button>
                <button id="ajustesBtn" class="icon-nav-btn" title="Ajustes">
                    <img src="assets/icon_ajustes.png" alt="Ajustes">
                </button>
            </div>
        </div>
        <div class="messages" id="chatBox"></div>
        <div class="input-area">
            <input type="text" id="chatMentoriaInput" placeholder="Escribe aqu√≠ tu sentir o tu canci√≥n..."
                autocomplete="off" spellcheck="false">
            <button id="sendBtn">‚ñ∂</button>
            <button id="micBtn">üé§</button>
        </div>
    </div>
    <div id="diarioModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="diarioContent"></div>
        </div>
    </div>
    <!-- Modal para Sesiones 1/1 (Premium) -->
    <div id="sesionModal" class="modal">
        <div class="modal-content sesion-modal-content">
            <span class="close-modal close-sesion">&times;</span>
            <h2>Mis Sesiones 1/1</h2>
            <div id="sessionQuotaInfo" class="session-quota-info">
                <!-- Se poblar√° con los minutos restantes -->
            </div>

            <div class="session-actions">
                <div class="session-group">
                    <h3>Sesiones Incluidas</h3>
                    <p class="session-desc">Dispones de 60 min mensuales (1 de 1h o 2 de 30min).</p>
                    <div class="booking-options">
                        <button id="book30Btn" class="btn-booking">Reservar 30 min</button>
                        <button id="book60Btn" class="btn-booking">Reservar 1 hora</button>
                    </div>
                </div>

                <div class="session-group extra">
                    <h3>1 Sesi√≥n con el Mentor o 1 Sesi√≥n extra</h3>
                    <p class="session-desc">Reserva aqu√≠ una sesi√≥n 1/1 si eres del Plan Profundiza o extra si eres de
                        Transforma.</p>
                    <div class="booking-options">
                        <button id="buyExtra30Btn" class="btn-booking btn-extra">Comprar Extra 30 min</button>
                        <button id="buyExtra60Btn" class="btn-booking btn-extra">Comprar Extra 1 hora</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal para elegir Plan (Upgrade) -->
    <div id="upgradeModal" class="modal">
        <div class="modal-content upgrade-modal-content">
            <span class="close-modal close-upgrade">&times;</span>
            <h2>Mejora tu Experiencia</h2>
            <p>Elige el plan que mejor se adapte a tu viaje vocal.</p>
            <div class="upgrade-options">
                <div class="upgrade-card pro">
                    <h3>Plan PRO</h3>
                    <p>Chat ilimitado y memoria relacional profunda.</p>
                    <button onclick="iniciarPago('pro')" class="btn-upgrade">Elegir Pro</button>
                </div>
                <div class="upgrade-card premium">
                    <h3>Plan TRANSFORMA</h3>
                    <p>Todo el PRO + Sesiones 1/1 y Plan a medida.</p>
                    <button onclick="iniciarPago('premium')" class="btn-upgrade">Elegir Transforma</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Mi Viaje (Roadmap) -->
    <div id="viajeModal" class="modal journey-modal">
        <div class="modal-content journey-content">
            <span class="close-modal close-viaje">&times;</span>
            <div class="journey-header">
                <h2>El viaje de mi vida</h2>
                <p>Vamos all√° con tu Viaje de Vida personal. Cada paso de este mapa, cada m√≥dulo, es una llave para
                    abrir un cerrojo de tu voz. Respira, conf√≠a y comienza a transformar tu historia.</p>
            </div>
            <div id="journeyRoadmap" class="roadmap-container">
                <!-- Se poblar√° din√°micamente desde mi_viaje/main.js -->
            </div>
        </div>
    </div>

    <!-- Modal de M√≥dulo de Coaching -->
    <div id="moduloModal" class="modal module-modal">
        <div class="modal-content module-content">
            <span class="close-modal close-modulo">&times;</span>
            <div id="moduloContainer">
                <div id="questionContainer"></div>
                <div class="module-navigation">
                    <button id="prevQBtn" class="nav-btn">Anterior</button>
                    <button id="nextQBtn" class="nav-btn">Siguiente</button>
                    <button id="finishModuleBtn" class="nav-btn finish-btn">Finalizar
                        M√≥dulo</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Ajustes -->
    <div id="settingsModal" class="modal">
        <div class="modal-content settings-modal-content">
            <span class="close-modal close-settings">&times;</span>
            <h2>Ajustes</h2>

            <div class="settings-section profile-info">
                <div id="settingsUserName" class="info-value">...</div>
                <div id="settingsUserTier" class="info-value">...</div>
            </div>

            <div class="settings-section">
                <h3>Respuesta del Mentor</h3>
                <div class="slider-group">
                    <div class="slider-labels">
                        <span>üß¨ T√©cnico</span>
                        <span>Enfoque</span>
                        <span>üïØÔ∏è Emocional</span>
                    </div>
                    <input type="range" id="focusSlider" min="0" max="1" step="0.1" value="0.5"
                        title="Enfoque del Mentor" placeholder="0.5">
                </div>
                <div class="slider-group">
                    <div class="slider-labels">
                        <span>üßò Neutro</span>
                        <span>Personalidad</span>
                        <span>üî• Motivador</span>
                    </div>
                    <input type="range" id="personalitySlider" min="0" max="1" step="0.1" value="0.5"
                        title="Personalidad del Mentor" placeholder="0.5">
                </div>
                <div class="slider-group">
                    <div class="slider-labels">
                        <span>‚ö° Breve/Directo</span>
                        <span>Extensi√≥n</span>
                        <span>üìú Detallado/Profundo</span>
                    </div>
                    <input type="range" id="lengthSlider" min="0" max="1" step="0.1" value="0.5"
                        title="Extensi√≥n de las respuestas" placeholder="0.5">
                </div>
            </div>

            <div class="settings-section">
                <h3>Preferencias</h3>
                <div class="setting-item">
                    <label for="languageSelect">Idioma del Mentor:</label>
                    <select id="languageSelect">
                        <option value="es">Espa√±ol</option>
                        <option value="en">English</option>
                        <option value="fr">Fran√ßais</option>
                        <option value="it">Italiano</option>
                        <option value="de">Deutsch</option>
                        <option value="ca">Catal√†</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="weeklyGoalInput">Objetivo Semanal (Opcional):</label>
                    <textarea id="weeklyGoalInput"
                        placeholder="¬øEn qu√© te enfocas esta semana? (ej: Preparar mi audici√≥n)"></textarea>
                </div>
            </div>

            <div class="settings-actions">
                <button id="clearHistoryBtn" class="danger-btn">Borrar Historial</button>
                <a href="preferences.html" class="preferences-btn">Gestionar preferencias de email y cuenta üåø</a>
                <button id="saveSettingsBtn" class="save-btn">Guardar Cambios</button>
                <p class="danger-hint"><strong>‚ö†Ô∏è ADVERTENCIA:</strong> Al borrar el historial se eliminar√°n todas tus
                    conversaciones anteriores con el Mentor, no solo las de esta sesi√≥n.</p>
            </div>
        </div>
    </div>

    <!-- MODAL DE CONSENTIMIENTO LEGAL -->
    <div id="legalModal" class="modal">
        <div class="modal-content legal-modal-content">
            <h2>Compromiso y Privacidad</h2>
            <p class="legal-intro">Al crear tu cuenta, te unes a este viaje de transformaci√≥n. Para proteger tu
                privacidad y la esencia de nuestra metodolog√≠a, te pedimos que aceptes lo siguiente:</p>

            <div class="legal-scroll-area">
                <div class="legal-section">
                    <h3>Propiedad del Contenido y Metodolog√≠a</h3>
                    <p>El usuario reconoce y acepta que todos los derechos de propiedad intelectual e industrial sobre
                        los contenidos de la aplicaci√≥n Despierta tu Voz (incluyendo, de forma enunciativa pero no
                        limitativa: el nombre de la aplicaci√≥n, logotipos, c√≥digo fuente, interfaz de usuario, as√≠ como
                        los textos, guiones y estructura de los 5 M√≥dulos de Sanaci√≥n Vocal, ejercicios de "Mi Viaje" y
                        las respuestas generadas por el Mentor Vocal IA) son titularidad exclusiva de Despierta tu Voz.
                    </p>

                    <h3>Licencia de Uso Personal</h3>
                    <p>Se concede al usuario una licencia de uso personal, no exclusiva e intransferible, para acceder y
                        utilizar el contenido con fines de autodescubrimiento y formaci√≥n personal. Queda estrictamente
                        prohibida la reproducci√≥n, distribuci√≥n, comunicaci√≥n p√∫blica, transformaci√≥n o cualquier otra
                        forma de explotaci√≥n de estos contenidos para fines comerciales o de formaci√≥n a terceros sin el
                        consentimiento expreso y por escrito del titular.</p>

                    <h3>Protecci√≥n de la Alquimia Vocal</h3>
                    <p>La estructura espec√≠fica del viaje (El Espejo del pasado, Ra√≠ces, Personaje, Altar y Prop√≥sito)
                        constituye una obra original protegida por la Ley de Propiedad Intelectual espa√±ola. El uso
                        indebido de esta metodolog√≠a fuera del entorno de la aplicaci√≥n podr√° dar lugar a las acciones
                        legales correspondientes.</p>

                    <div class="privacy-notice-box">
                        <p><strong>Al aceptar, consientes el tratamiento de los datos que compartas con el Mentor IA
                                para la personalizaci√≥n de tu proceso de aprendizaje y desbloqueo vocal.</strong></p>
                    </div>

                    <h3>Pol√≠tica de Privacidad y Protecci√≥n de Datos</h3>
                    <p><strong>1. ¬øQui√©n cuida de tus datos?</strong><br>
                        El responsable de tus datos es Despierta tu voz. Tratamos tu informaci√≥n con el √∫nico fin de
                        proporcionarte la experiencia de mentor√≠a vocal personalizada que buscas.</p>

                    <p><strong>2. Tu privacidad con la IA (El Mentor Vocal):</strong><br>
                        - <strong>Privacidad de las charlas:</strong> Tus conversaciones con el Mentor son privadas. No
                        vendemos tus datos a terceros ni los usamos para publicidad.<br>
                        - <strong>Uso del historial:</strong> En el Plan Pro/Premium, almacenamos el historial de tus
                        charlas y los datos de tus M√≥dulos para que la IA pueda tener "memoria" y ofrecerte un
                        acompa√±amiento coherente.<br>
                        - <strong>Entrenamiento:</strong> Los datos se procesan de forma anonimizada para mejorar la
                        precisi√≥n de las respuestas del Mentor, siempre bajo est√°ndares de seguridad de cifrado.</p>

                    <p><strong>3. ¬øQu√© datos recogemos?</strong><br>
                        - Datos de registro (Nombre y email).<br>
                        - Datos de uso (M√≥dulos completados y progreso en "Mi Viaje").<br>
                        - Datos de pago (Gestionados de forma segura a trav√©s de Stripe, nosotros nunca vemos ni
                        almacenamos tu n√∫mero de tarjeta).</p>

                    <p><strong>4. Tus derechos:</strong><br>
                        En cualquier momento puedes escribirnos a app-mentor@despiertatuvoz.com para solicitar el acceso
                        a tus datos, rectificarlos o pedir que los borremos definitivamente de nuestro sistema (Derecho
                        al Olvido).</p>
                </div>
            </div>

            <div class="legal-checks">
                <label class="check-item">
                    <input type="checkbox" id="checkTerms">
                    <span>He le√≠do y acepto los T√©rminos y Condiciones y la Pol√≠tica de Privacidad.</span>
                </label>
                <label class="check-item">
                    <input type="checkbox" id="checkMedical">
                    <span>Entiendo que el Mentor Vocal IA es una herramienta de acompa√±amiento personal y no sustituye
                        el asesoramiento m√©dico o terap√©utico profesional.</span>
                </label>
            </div>

            <div class="legal-actions">
                <button id="cancelLegalBtn" class="cancel-btn">Cancelar</button>
                <button id="confirmLegalBtn" class="save-btn" disabled>Confirmar y Seguir</button>
            </div>
        </div>
    </div>

    <footer class="app-footer">
        <p>¬© 2026 Despierta tu Voz. Todos los derechos reservados.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="js/stripe-checkout.js"></script>
    <script type="module" src="main.js?v=5.3"></script>
</body>


</html>